{"version":3,"sources":["pages/unblock/util/match.tsx","pages/unblock/constant/configTypeLabelMap.ts","pages/unblock/component/UnblockWebRestrictionsConfigForm.tsx","pages/unblock/component/UnblockWebRestrictionsConfigList.tsx","pages/unblock/UnblockWebRestrictionsConfig.tsx"],"names":[],"mappings":";;;;;;ACAO,IAAM,kBAAkB,GAA6B;AGA5D,AFAA,ACAA,AFCE,ADDI,ECCJ,MAAM,CDDQ,CCCN,IADkD,ADAtD,CACJ,IADI,EAEJ,MAFI,EAIiE;ACFrE,ADIA,ECJA,IAAI,ADIA,ECJE,IAFoD,CDM/C,MAAP,KAAkB,QAAtB,EAAgC;AIJlC,AFDA,ACAA,AFEE,ADIE,ECJF,SDIS,CCJC,EAAE,CDIC,CAAC,ICP4C,ADOjD,CAAU,QAAV,CAAmB,MAAnB,CAAP;ACHF,ADIC,ECJD,CDEA,ICFK,EAAE,ADIA;AILT,AFDA,ACAA,AFF4D,ADQnD,CCRF,ODSI,IADF,GACe,MADf,CACE,IADF;AAAA,QACQ,GADR,GACe,MADf,CACQ,GADR;AIJT,AFDA;AFOI,YAAQ,IAAR;AILJ,AJMM,WAAK,QAAL;AACE,eAAO,IAAI,CAAC,IAAL,CAAU,QAAV,CAAmB,GAAnB,CAAP;AINR,ADIA;AHGM,WAAK,MAAL;AACE,eAAO,IAAI,CAAC,IAAL,KAAc,GAArB;AGDR,IAAM,gCAAgC,GAAwB,SAAxD,gCAAwD,CAAA,KAAK,EAAG;AACpE,AHCI,SGAF,EHAO,GGAP,CAAA,QHAE,KGAF,CAAA,KAAA,EAAA,IAAA,EACE,KAAA,CAAA,aAAA,CAAA,IAAA,EAAA,IAAA,EAAA,kDAAA,CADF,EAEE,KAAA,CAAA,aAAA,CAAC,UAAD,EAAK;AACH,AHFA,IGEA,UAAU,CHFH,CGEK,GHFD,CAAC,CGEK,CAAC,EHFX,CAAU,CGCd,SHDI,CAAqB,GAArB,CAAP;AGGA,IAAA,UAAU,EAAE,oBAAC,MAAD,EAAsB,CAAtB;AAAA,AHFd,WAAK,EGGD,KAAA,AHHJ,CGGI,aAAA,CAAC,WAAK,IAAN,EAAU;AACR,AHHJ,QGGI,GAAG,EAAE,CADG,CHFL,IAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,IAAI,CAAC,IAA1B,CAAP;AGII,AHZR,QGYQ,OAAO,EAAE,CACP,KAAA,CAAA,aAAA,CAAC,YAAD,EAAO;AACL,AHJb,UGIa,OAAO,EAAE,MAAM,CAAC,MADX;AAEL,AHJf,UGIe,QAAQ,EAAE;AAAA,mBAAM,KAAK,CAAC,QAAN,CAAe,MAAf,CAAN;AAAA;ADpB1B,ACkBqB,SAAP,CADO,EAKP,KAAA,CAAA,aAAA,CAAC,YAAD,EAAO;AACL,UAAA,IAAI,EAAE,QADD;AAEL,UAAA,OAAO,EAAE;ADrBzB,ACqByB,IDrBnB,eCqByB,KAAK,CAAC,QAAN,CAAe,EDrBR,GAEjC,CCmB0B,CAAN,ODrBnB,gCAED,CAAA,KAAK,EAAG;AAAA,ACmBY,sBDlBR,WAAK,OAAL,EADJ;AAAA,ACiBQ,SAAP,EAEuC,cAFvC,CALO;ADZR,ACUO,MDTX,CCSC,EAeE,CDzBC,ICyBD,CAAA,aAAA,CAAC,WAAK,IAAL,CAAU,IAAX,EAAe;AACb,QAAA,KAAK,EACH,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,IAAA,EACE,KAAA,CAAA,aAAA,CAAC,SAAD,EAAI,IAAJ,EAAM,uCAAmB,MAAM,CAAC,IAA1B,CAAN,CADF,EAEE,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AD1BhB,AC2BkB,UAAA,CD3BT,IC2Bc,EAAE,CD3BzB,GAAgB;AACd,AC2BkB,ID3BlB,IAAI,CAAC,GC2Ba,QD3BlB,AC2B0B,EAAE,QADL;ADzBxB,AC2BmB,YAAA,YAAY,EAAE,UAFT;AAGL,YAAA,UAAU,EAAE;AD1BhC,ACuByB,WDvBhB,ACsBO,QDtBhB,CAAkB,MAAlB,EAAgD;AAC9C,AC2BgB,QD3BV,EC2BU,KD3BH,AC2BQ,EAAE,CD3BP,KC2Ba,CD3B7B,AC2B8B;AANhB,SAAA,EAQG,MAAM,CAAC,IAAP,KAAgB,OAAhB,GACC,MAAM,CAAC,GADR,GAGC,KAAA,CAAA,aAAA,CAAA,GAAA,EAAA;AD3BlB,AC4BoB,QD5BhB,CAAC,CC4Be,IAAI,EACF,CAAC,MAAM,CAAC,GD7BnB,CC6BY,GD7BR,EC6BwB,CD7B5B,CAAQ,MC6BI,CD7BG,CAAC,CC6BuB,MD7BvC,CAAN,EAAgC,CC6Bd,GAAwC,EAAzC,CD7BjB,CAAL,EAA+C,AC8BzB,MAAM,CAAC;AD7B3B,AC0BgB,SAAA,EAMG,MAAM,CAAC,EDhClB,CC0BQ,CAXJ,CAFF,CDbV,ACWqB,CDXR,mBAAb;ACsCQ,QAAA,WAAW,EAAE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,IAAA,EAAM,MAAM,CAAC,MAAb;ADrCrB,ACUqB,OAAf,CAfF,CADU;ADOf,ACPe;AAFT,GAAL,CAFF,CADF;ADaE,AC0CH,CAxDD,GDcI,MAAM,CAAC,cAAP,CAAsB,GAAtB,CAA0B;AACxB,MAAA,IAAI,EAAE,OAAO,CAAC,IADU;AAExB,MAAA,GAAG,EAAE,IC0CI,GD1CG,CAAC;AAFW,KAA1B;;AAIA,kBAAQ,OAAR,CAAgB,MAAhB;;AACA,IAAA,KAAK,CAAC,QAAN;AACA,IAAA,OAAO;AACR;;AAED,SACE,KAAA,CAAA,aAAA,CAAC,UAAD,EAAK;AAAC,IAAA,IAAI,EAAE,IAAP;AAAa,IAAA,QAAQ,EAAE,QAAvB;AAAiC,IAAA,MAAM,EAAE;AAAzC,GAAL,EACE,KAAA,CAAA,aAAA,CAAC,WAAK,IAAN,EAAU;AACR,IAAA,KAAK,EAAE,MADC;AE5BhB,AF8BQ,IE9BF,AF8BE,IAAI,EAAE,MAFE,EE5BI,GAClB,MAAM,CAAC,mDAAD,CADR;AF+BQ,IAAA,KAAK,EAAE,CAAC;AE5BhB,AF4BkB,IE5BZ,EF4BY,QAAQ,EAAE,IAAZ,YE5BkB,GAAwB,SAApD,4BAAoD,GAAK;AAC7D,AF2BgC,ME3B5B,AF2B4B,CE3B3B,MF2BkC,EAAE,ME3BzC,EAAqB;AACnB,AF0BY,KAAD,MEzBT,KAAA,CAAA,aAAA,CAAC,oBAAD,EAAY;AACV,AFqBQ,GAAV,EAKE,CE1BA,IF0BA,CE1BK,AF0BL,EE1BM,WF0BN,CAAC,YAAD,EAAO,qFE3BG;AAEV,AF0BE,IAAA,EE1BF,IAAI,CF0BK,CE1BH,CF0BK,MAAM,CAAC,OAAP,CAAe,sCAAf,EAAmC,GAAnC,CAAuC;AE5BxC,AF4BwC,KE5BpD,CADF;AAMD,AFuBuD,UAAE,KAAF;AAAA,UAAS,KAAT;AE/BK,kBAUzB,oBAAS;AAAA,AFqBW,WErBL,EFqB0B,YErBZ,CAAC,IAAf,EAAN;AAAA,AFsBnC,GEtB0B,CAVyB,IFgCnD,KAAK,EAAL,KADmE;AE/BhB,AFiCnD,QAAA,KAAK,EAAL;AEjCmD,AF+BgB,MErBtE,CFqBiD,SE/BK;AAAA,AF+BL,KAAvC,CErBE,aAV0C;AF8BhD,GAAP,CALF,CADF,EAaE,KAAA,CAAA,aAAA,CAAC,WAAK,IAAN,EAAU;AEzBd,AF0BM,IAAA,KAAK,EE1BF,AF0BI,KADC,OEzBd,GAAqB;AACnB,AF0BI,IAAA,IE1BE,AF0BE,EAAE,EE1BA,GAAG,AFwBD,cExBe,CAAC,IAAf,EAAb;AACA,AF0BI,IE1BJ,AF0BI,KAAK,EAAE,CAAC,KE1BC,CAAC,IAAD,CAAb;AACA,AFyBc,IEzBd,EFyBc,KEzBP,CAAC,EFyBc,CEzBtB,CAAY,AFyBY,IAAZ,MEzBZ,EAAwB,IAAxB;AACD,AFwB+B,MAAA,OAAO,EAAE;AAA3B,KAAD;AEvBb,AFoBc,GAAV,EAKE,KAAA,CEzBG,AFyBH,WEzBN,EFyBM,CEzBc,AFyBb,WAAD,EAAM,IAAN,CALF,CAbF,EAoBE,KAAA,CAAA,aAAA,CAAC,WAAK,IAAN,EAAU;AE1BZ,AF2BI,IE3BJ,AF2BI,KAAK,EAAE,OE3BG,CAAC,KAAf,AF0BY;AEzBZ,AF2BI,IE3BJ,AF2BI,IAAI,EAAE,ME3BE,GFyBA;AAGR,IAAA,KAAK,EAAE,CACL;AE5BN,AF4BQ,MAAA,QAAQ,EAAE,EE5BV,EF4BF,KE5BN,CAAgB,MAAhB;AACD,AF2ByB,MAAA,OAAO,EAAE;AAA3B,KADK,EAEL;AE1BR,AF2BU,MAAA,IAAI,CE3BC,CF2BC,KADR,ME1BR,GAA2B;AF4BjB,MAAA,OAAO,EAAE;AAFX,KAFK;AAHC,GAAV,EAWE,KAAA,CAAA,aAAA,CAAC,WAAD,EAAM,IAAN,CAXF,CApBF,EAiCE,KAAA,CAAA,aAAA,CAAC,WAAK,IAAN,EAAU,IAAV,EACE,KAAA,CAAA,aAAA,CAAC,YAAD,EAAO;AACL,IAAA,IAAI,EAAC,SADA;AAEL,IAAA,QAAQ,EAAE,QAFL;AAGL,IAAA,KAAK,EAAE;AErCb,AFsCQ,MAAA,WAAW,EAAE,EEtCf,cAAc,CAAC,MAAf,EAAN;AFqCa;AAHF,GAAP,EAKG,cALH,CADF,EAUE,KAAA,CAAA,aAAA,CAAC,YAAD,EAAO;AE1CX,AF0CY,IAAA,QAAQ,EE1CpB,AF0CsB,OAAX,KE1CC;AF0CmB,IAAA,OAAO,EAAE;AEzCxC,AFyCW,GAAP,EAA2C,cAA3C,CAVF,CAjCF,CADF,MEGU,OAAR,CAAgB,MAAhB;AF+CH,CA9ED;;eAgFe;;;;;;AEhDZ;;AAED,WAAS,YAAT,CAAsB,MAAtB,EAAyC;AACvC,IAAA,OAAO,CAAC,GAAR,CAAY,cAAZ,EAA4B,MAAM,CAAC,GAAnC;AACA,IAAA,cAAc,CAAC,MAAf,CAAsB,MAAM,CAAC,GAA7B;AACA,IAAA,YAAY;;AACZ,kBAAQ,OAAR,CAAgB,MAAhB;AACD;;AAED,WAAS,YAAT,CAAsB,MAAtB,EAAyC;AACvC,IAAA,OAAO,CAAC,GAAR,CAAY,gBAAZ,EAA8B,MAA9B;AACA,IAAA,cAAc,CAAC,MAAf,CAAsB,MAAM,CAAC,GAA7B;AACA,IAAA,YAAY;AACb;;AAED,SACE,KAAA,CAAA,aAAA,CAAC,wBAAD,EAAgB;AACd,IAAA,KAAK,EAAE,KADO;AAEd,IAAA,KAAK,EACH,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,IAAA,EACE,KAAA,CAAA,aAAA,CAAC,YAAD,EAAO;AACL,MAAA,IAAI,EAAC,SADA;AAEL,MAAA,OAAO,EAAE,WAFJ;AAGL,MAAA,KAAK,EAAE;AAAE,QAAA,WAAW,EAAE;AAAf;AAHF,KAAP,EAG2B,cAH3B,CADF,EAQE,KAAA,CAAA,aAAA,CAAC,YAAD,EAAO;AAAC,MAAA,IAAI,EAAC,SAAN;AAAgB,MAAA,OAAO,EAAE;AAAzB,KAAP,EAA4C,cAA5C,CARF;AAHY,GAAhB,EAiBE,KAAA,CAAA,aAAA,CAAC,yCAAD,EAAiC;AAAC,IAAA,QAAQ,EAAE;AAAX,GAAjC,CAjBF,EAkBE,KAAA,CAAA,aAAA,CAAC,yCAAD,EAAiC;AAC/B,IAAA,IAAI,EAAE,UADyB;AAE/B,IAAA,QAAQ,EAAE,YAFqB;AAG/B,IAAA,QAAQ,EAAE;AAHqB,GAAjC,CAlBF,CADF;AA0BD,CApED;;eAsEe","file":"UnblockWebRestrictionsConfig.95b698bc.js","sourceRoot":"..\\src","sourcesContent":["export function match(\r\n  href: URL,\r\n  config:\r\n    | string\r\n    | { type: 'domain' | 'link' | 'linkPrefix' | 'regex'; url: string },\r\n) {\r\n  if (typeof config === 'string') {\r\n    return href.host.includes(config)\r\n  } else {\r\n    const {type, url} = config\r\n    switch (type) {\r\n      case 'domain':\r\n        return href.host.includes(url)\r\n      case 'link':\r\n        return href.href === url\r\n      case 'linkPrefix':\r\n        return href.href.startsWith(url)\r\n      case 'regex':\r\n        return new RegExp(url).test(href.href)\r\n    }\r\n  }\r\n}\r\n","export const configTypeLabelMap: Record<TypeEnum, string> = {\n  domain: '域名',\n  link: '链接',\n  linkPrefix: '链接前缀',\n  regex: '正则表达式',\n}\n","import { Button, Form, Input, message, Select } from 'antd'\nimport { match } from '../util/match'\nimport { configTypeLabelMap } from '../constant/configTypeLabelMap'\nimport * as React from 'react'\n\n/**\n * 配置新增表单\n */\nconst UnblockWebRestrictionsConfigForm: React.FC<{\n  onReload: () => void\n}> = props => {\n  const [form] = Form.useForm()\n\n  function onReset() {\n    form.resetFields()\n  }\n\n  function onFinish(values: Record<string, string>) {\n    const _values = values as {\n      type: TypeEnum\n      url: string\n      tempUrl: string\n    }\n    if (!match(new URL(_values.tempUrl), _values)) {\n      message.warn('测试需要匹配的 URL 未能匹配！')\n      return\n    }\n    window.configBlockApi.add({\n      type: _values.type,\n      url: _values.url,\n    })\n    message.success('添加成功')\n    props.onReload()\n    onReset()\n  }\n\n  return (\n    <Form form={form} onFinish={onFinish} layout={'vertical'}>\n      <Form.Item\n        label={'匹配模式'}\n        name={'type'}\n        rules={[{ required: true, message: '匹配模式没有选择' }]}\n      >\n        <Select\n          options={Object.entries(configTypeLabelMap).map(([value, label]) => ({\n            label,\n            value,\n          }))}\n        />\n      </Form.Item>\n      <Form.Item\n        label={'匹配值'}\n        name={'url'}\n        rules={[{ required: true, message: '匹配值不能为空' }]}\n      >\n        <Input />\n      </Form.Item>\n      <Form.Item\n        label={'测试需要匹配的 URL'}\n        name={'tempUrl'}\n        rules={[\n          { required: true, message: '测试需要匹配的 URL 不能为空' },\n          {\n            type: 'url',\n            message: '测试需要匹配的 URL 必须是个 URL 啊喂 (#`O′)',\n          },\n        ]}\n      >\n        <Input />\n      </Form.Item>\n      <Form.Item>\n        <Button\n          type=\"primary\"\n          htmlType={'submit'}\n          style={{\n            marginRight: 8,\n          }}\n        >\n          提交\n        </Button>\n        <Button htmlType={'reset'} onClick={onReset}>\n          清空\n        </Button>\n      </Form.Item>\n    </Form>\n  )\n}\n\nexport default UnblockWebRestrictionsConfigForm\n","import * as React from 'react'\nimport { Button, List, Switch, Tag } from 'antd'\nimport { configTypeLabelMap } from '../constant/configTypeLabelMap'\n\ntype PropsType = {\n  list: BlockConfig[]\n  onRemove: (config: BlockConfig) => void\n  onSwitch: (config: BlockConfig) => void\n}\n\n/**\n * 屏蔽列表\n */\nconst UnblockWebRestrictionsConfigList: React.FC<PropsType> = props => {\n  return (\n    <div>\n      <h2>本地屏蔽配置列表</h2>\n      <List\n        dataSource={props.list}\n        renderItem={(config: BlockConfig, i: number) => (\n          <List.Item\n            key={i}\n            actions={[\n              <Switch\n                checked={config.enable}\n                onChange={() => props.onSwitch(config)}\n              />,\n              <Button\n                type={'danger' as any}\n                onClick={() => props.onRemove(config)}\n              >\n                删除\n              </Button>,\n            ]}\n          >\n            <List.Item.Meta\n              title={\n                <div>\n                  <Tag>{configTypeLabelMap[config.type]}</Tag>\n                  <span\n                    style={{\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis',\n                      whiteSpace: 'nowrap',\n                    }}\n                    title={config.url}\n                  >\n                    {config.type === 'regex' ? (\n                      config.url\n                    ) : (\n                      <a\n                        href={\n                          (config.type === 'domain' ? 'https://' : '') +\n                          config.url\n                        }\n                      >\n                        {config.url}\n                      </a>\n                    )}\n                  </span>\n                </div>\n              }\n              description={<div>{config.enable}</div>}\n            />\n          </List.Item>\n        )}\n      />\n    </div>\n  )\n}\n\nexport default UnblockWebRestrictionsConfigList\n","import * as React from 'react'\r\nimport { useState } from 'react'\r\nimport { Button, message, Result } from 'antd'\r\nimport UnblockWebRestrictionsConfigForm from './component/UnblockWebRestrictionsConfigForm'\r\nimport UnblockWebRestrictionsConfigList from './component/UnblockWebRestrictionsConfigList'\r\nimport BasicLayoutCard from '../../components/layout/BasicLayoutCard'\r\nimport LayoutEmpty from '../../components/layout/LayoutEmpty'\r\n\r\ntype PropsType = {}\r\n\r\nconst configBlockApi =\r\n  window['com.rxliuli.UnblockWebRestrictions.configBlockApi']\r\n\r\nconst UnblockWebRestrictionsConfig: React.FC<PropsType> = () => {\r\n  if (!configBlockApi) {\r\n    return (\r\n      <LayoutEmpty\r\n        title=\"您还未安装解除网页禁止复制/粘贴的脚本\"\r\n        href={'https://greasyfork.org/zh-CN/scripts/391193'}\r\n      />\r\n    )\r\n  }\r\n\r\n  const [configList, setConfigList] = useState(() => configBlockApi.list())\r\n\r\n  function handleReload() {\r\n    const list = configBlockApi.list()\r\n    setConfigList(list)\r\n    console.log('reload: ', list)\r\n  }\r\n  function handleClear() {\r\n    configBlockApi.clear()\r\n    handleReload()\r\n    message.success('清空成功')\r\n  }\r\n\r\n  async function handleUpdate() {\r\n    await configBlockApi.update()\r\n    handleReload()\r\n    message.success('更新成功')\r\n  }\r\n\r\n  function handleRemove(config: BlockConfig) {\r\n    console.log('remove key: ', config.key)\r\n    configBlockApi.remove(config.key)\r\n    handleReload()\r\n    message.success('删除成功')\r\n  }\r\n\r\n  function handleSwitch(config: BlockConfig) {\r\n    console.log('handleSwitch: ', config)\r\n    configBlockApi.switch(config.key)\r\n    handleReload()\r\n  }\r\n\r\n  return (\r\n    <BasicLayoutCard\r\n      title={'配置页'}\r\n      extra={\r\n        <div>\r\n          <Button\r\n            type=\"primary\"\r\n            onClick={handleClear}\r\n            style={{ marginRight: 8 }}\r\n          >\r\n            清空\r\n          </Button>\r\n          <Button type=\"primary\" onClick={handleUpdate}>\r\n            更新\r\n          </Button>\r\n        </div>\r\n      }\r\n    >\r\n      <UnblockWebRestrictionsConfigForm onReload={handleReload} />\r\n      <UnblockWebRestrictionsConfigList\r\n        list={configList}\r\n        onRemove={handleRemove}\r\n        onSwitch={handleSwitch}\r\n      />\r\n    </BasicLayoutCard>\r\n  )\r\n}\r\n\r\nexport default UnblockWebRestrictionsConfig\r\n"]}